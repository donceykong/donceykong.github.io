<div class="stl-viewer" style="{{ include.extrastyle }}">
  <script src="https://unpkg.com/three@0.87.1/build/three.js"></script>
  <script src="https://unpkg.com/three@0.87.1/examples/js/loaders/STLLoader.js"></script>
  <script src="https://unpkg.com/three@0.87.1/examples/js/controls/OrbitControls.js"></script>
  
  <div id="stl-container-{{ include.src | slugify }}" 
       style="width: {{ include.width }}px; height: {{ include.height }}px; margin: 0 auto;">
  </div>
  
  <script>
    (function() {
      var scene = new THREE.Scene();
      var camera = new THREE.PerspectiveCamera(75, {{ include.width }}/{{ include.height }}, 0.1, 1000);
      
      var renderer = new THREE.WebGLRenderer({ antialias: true });
      renderer.setSize({{ include.width }}, {{ include.height }});
      document.getElementById('stl-container-{{ include.src | slugify }}').appendChild(renderer.domElement);
      
      var loader = new THREE.STLLoader();
      loader.load('{{ include.src | relative_url }}', function(geometry) {
        var material = new THREE.MeshPhongMaterial({ 
          color: 0xAAAAAA, 
          specular: 0x111111, 
          shininess: 200 
        });
        var mesh = new THREE.Mesh(geometry, material);
        
        geometry.computeBoundingBox();
        geometry.center();
        
        scene.add(mesh);
      });
      
      var light = new THREE.DirectionalLight(0xFFFFFF);
      light.position.set(1, 1, 1);
      scene.add(light);
      
      var light2 = new THREE.DirectionalLight(0xFFFFFF, 0.5);
      light2.position.set(-1, -1, -1);
      scene.add(light2);
      
      var ambientLight = new THREE.AmbientLight(0x404040);
      scene.add(ambientLight);
      
      camera.position.z = 5;
      
      var controls = new THREE.OrbitControls(camera, renderer.domElement);
      
      function animate() {
        requestAnimationFrame(animate);
        controls.update();
        renderer.render(scene, camera);
      }
      animate();
    })();
  </script>
</div>

